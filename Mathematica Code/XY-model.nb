(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     87322,       2083]
NotebookOptionsPosition[     83506,       2010]
NotebookOutlinePosition[     84176,       2032]
CellTagsIndexPosition[     84133,       2029]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Local Optimization on the Gaussian manifold",
 FontWeight->"Bold"]], "Title",
 CellChangeTimes->{{3.775533871477256*^9, 
  3.775533884950554*^9}},ExpressionUUID->"f8b9e2fb-b1a1-4ed6-8c9b-\
37b0f3f20bec"],

Cell["\<\
This notebook is intended as a guide to using the optimization algorithm \
performing gradient descent over the manifold of pure bosonic or fermionic \
Gaussian states.\
\>", "Text",
 CellChangeTimes->{{3.775533968846167*^9, 3.775534051710011*^9}, {
  3.7760814927838573`*^9, 3.776081670988261*^9}, {3.776083659704749*^9, 
  3.776083668911891*^9}},ExpressionUUID->"151f29c7-c001-4f64-9fc6-\
433ea64370e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quit", "[", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7757177108120728`*^9, 3.775717711628503*^9}, {
  3.775722133377762*^9, 3.7757221418720393`*^9}, {3.7757221782620244`*^9, 
  3.775722192328006*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"0b68122c-602a-4ffb-bddb-831b264acb38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "GaussianOptimization`"}]}], "Input",
 CellChangeTimes->{{3.7758024697534122`*^9, 3.775802483170392*^9}, {
  3.776575995998288*^9, 3.7765759973038263`*^9}, {3.777915116948509*^9, 
  3.777915118034244*^9}, {3.7812763515283604`*^9, 3.7812763527430987`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"503c86a9-502e-4932-a8c7-48511032d24a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selected examples: EoP and CoP", "Title",
 CellChangeTimes->{{3.775539576630558*^9, 3.775539581512989*^9}, {
  3.775722619737546*^9, 
  3.775722626721094*^9}},ExpressionUUID->"2476762e-e7ac-4684-8f66-\
93120ddc5dcc"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Reference implementation",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.775541412824267*^9, 3.7755416727390947`*^9}, {
  3.7755421075764008`*^9, 3.775542108507226*^9}, {3.77572309702594*^9, 
  3.775723107081567*^9}, {3.7760828975986233`*^9, 3.7760829005628567`*^9}, {
  3.777889311762621*^9, 3.7778893565160174`*^9}, {3.781267498818635*^9, 
  3.7812675066049166`*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"ca48de36-2306-46c3-9328-65aaa5ee769d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", "11"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Total", " ", "number", " ", "lattice", " ", "sites"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"J", "=", "2"}], ";", 
   RowBox[{"h", "=", "1"}], ";", 
   RowBox[{"\[Gamma]", "=", ".5"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"XY", " ", "model", " ", "parameter"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]", "[", "k_", "]"}], "=", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["h", "2"], "+", 
     RowBox[{"2", "h", " ", "J", " ", 
      RowBox[{"Cos", "[", "k", "]"}]}], "+", 
     SuperscriptBox["J", "2"], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Gamma]", "2"], "-", "1"}], ")"}], 
      SuperscriptBox["J", "2"], 
      SuperscriptBox[
       RowBox[{"Sin", "[", "k", "]"}], "2"]}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "k_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "J"}], " ", 
     RowBox[{"Cos", "[", "k", "]"}]}], "-", "h"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "k_", "]"}], "=", 
   RowBox[{"\[Gamma]", " ", "J", " ", 
    RowBox[{"Sin", "[", "k", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u", "[", "k_", "]"}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{"\[Epsilon]", "[", "k", "]"}], "+", 
     RowBox[{"a", "[", "k", "]"}]}], 
    SqrtBox[
     RowBox[{"2", 
      RowBox[{"\[Epsilon]", "[", "k", "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "k", "]"}], "+", 
        RowBox[{"a", "[", "k", "]"}]}], ")"}]}]]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", "k_", "]"}], "=", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"b", "[", "k", "]"}]}], 
     SqrtBox[
      RowBox[{"2", 
       RowBox[{"\[Epsilon]", "[", "k", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "k", "]"}], "+", 
         RowBox[{"a", "[", "k", "]"}]}], ")"}]}]]]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"block1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"u", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], "]"}], 
            "]"}], "2"], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", 
            FractionBox[
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], 
            RowBox[{"(", 
             RowBox[{"j", "-", "l"}], ")"}], " "}]]}], "-", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"v", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], "]"}], 
            "]"}], "2"], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", 
            FractionBox[
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], 
            RowBox[{"(", 
             RowBox[{"l", "-", "j"}], ")"}], " "}]]}]}], "//", "N"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"L", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "0", ",", 
       RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"block2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{
           RowBox[{"u", "[", 
            FractionBox[
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], "]"}], 
           RowBox[{"v", "[", 
            FractionBox[
             RowBox[{
              RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], "]"}]}],
           "]"}], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", 
             FractionBox[
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], 
             RowBox[{"(", 
              RowBox[{"l", "-", "j"}], ")"}], " "}]], "-", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", 
             FractionBox[
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], 
             RowBox[{"(", 
              RowBox[{"j", "-", "l"}], ")"}], " "}]]}], ")"}]}], "//", "N"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"L", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "0", ",", 
       RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Jtot", "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[ImaginaryI]", "L"]}], 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {"block1", "block2"},
        {
         RowBox[{"Conjugate", "[", 
          RowBox[{"Transpose", "[", "block2", "]"}], "]"}], 
         RowBox[{"-", 
          RowBox[{"Conjugate", "[", "block1", "]"}]}]}
       }], "\[NoBreak]", ")"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TRA", "=", 
   RowBox[{"GOqqppFROMaabb", "[", "L", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JTRA", "=", 
   RowBox[{
    RowBox[{"TRA", ".", "Jtot", ".", 
     RowBox[{"Transpose", "[", "TRA", "]"}]}], "//", "Chop"}]}], ";", 
  RowBox[{"JTRA", "//", "MatrixForm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Jtot", ".", "Jtot"}], "//", "Chop"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.781267582253107*^9, 3.7812675925957627`*^9}, {
  3.781267949317358*^9, 3.7812679693686466`*^9}, {3.781274351008572*^9, 
  3.7812743826516976`*^9}, {3.781276665331584*^9, 3.7812766660955334`*^9}, {
  3.78127721111355*^9, 3.78127726214299*^9}, {3.781278110287891*^9, 
  3.7812781198333464`*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"eb1a0cfb-3065-47a2-8a93-7dcf054e6d2b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0.2976182482480866`", "0.8854318264141715`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.02004996466319413`", 
      "0.05980486995604647`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.0104087125984492`", 
      "0.00334581200954714`", 
      RowBox[{"-", "0.011624724071965924`"}], "0.04130706006451381`", 
      RowBox[{"-", "0.12316898331781567`"}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0.12316898331781567`", "0.2976182482480866`", "0.8854318264141715`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.02004996466319413`", 
      "0.05980486995604647`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.0104087125984492`", 
      "0.00334581200954714`", 
      RowBox[{"-", "0.011624724071965924`"}], "0.04130706006451381`"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.04130706006451379`"}], "0.12316898331781567`", 
      "0.2976182482480866`", "0.8854318264141715`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.02004996466319413`", 
      "0.05980486995604647`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.0104087125984492`", 
      "0.00334581200954714`", 
      RowBox[{"-", "0.011624724071965924`"}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0.011624724071965877`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.12316898331781567`", 
      "0.2976182482480866`", "0.8854318264141715`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.02004996466319413`", 
      "0.05980486995604647`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.0104087125984492`", 
      "0.00334581200954714`"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.0033458120095471106`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.12316898331781567`", 
      "0.2976182482480866`", "0.8854318264141715`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.02004996466319413`", 
      "0.05980486995604647`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.0104087125984492`"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.010408712598449088`"}], 
      RowBox[{"-", "0.0033458120095471106`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.12316898331781567`", 
      "0.2976182482480866`", "0.8854318264141715`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.02004996466319413`", 
      "0.05980486995604647`", 
      RowBox[{"-", "0.04062862299231075`"}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0.040628622992310764`", 
      RowBox[{"-", "0.010408712598449088`"}], 
      RowBox[{"-", "0.0033458120095471106`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.12316898331781567`", 
      "0.2976182482480866`", "0.8854318264141715`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.02004996466319413`", 
      "0.05980486995604647`"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.05980486995604647`"}], "0.040628622992310764`", 
      RowBox[{"-", "0.010408712598449088`"}], 
      RowBox[{"-", "0.0033458120095471106`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.12316898331781567`", 
      "0.2976182482480866`", "0.8854318264141715`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.02004996466319413`"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.020049964663194128`"}], 
      RowBox[{"-", "0.05980486995604647`"}], "0.040628622992310764`", 
      RowBox[{"-", "0.010408712598449088`"}], 
      RowBox[{"-", "0.0033458120095471106`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.12316898331781567`", 
      "0.2976182482480866`", "0.8854318264141715`", 
      RowBox[{"-", "0.3235320832536838`"}]},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0.32353208325368393`", 
      RowBox[{"-", "0.020049964663194128`"}], 
      RowBox[{"-", "0.05980486995604647`"}], "0.040628622992310764`", 
      RowBox[{"-", "0.010408712598449088`"}], 
      RowBox[{"-", "0.0033458120095471106`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.12316898331781567`", 
      "0.2976182482480866`", "0.8854318264141715`"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.8854318264141715`"}], "0.32353208325368393`", 
      RowBox[{"-", "0.020049964663194128`"}], 
      RowBox[{"-", "0.05980486995604647`"}], "0.040628622992310764`", 
      RowBox[{"-", "0.010408712598449088`"}], 
      RowBox[{"-", "0.0033458120095471106`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.12316898331781567`", 
      "0.2976182482480866`"},
     {"0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}], 
      RowBox[{"-", "0.010408712598449088`"}], "0.040628622992310764`", 
      RowBox[{"-", "0.05980486995604647`"}], 
      RowBox[{"-", "0.020049964663194128`"}], "0.32353208325368393`", 
      RowBox[{"-", "0.8854318264141715`"}], "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0"},
     {"0.8854318264141715`", "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}], 
      RowBox[{"-", "0.010408712598449088`"}], "0.040628622992310764`", 
      RowBox[{"-", "0.05980486995604647`"}], 
      RowBox[{"-", "0.020049964663194128`"}], "0.32353208325368393`", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}], 
      RowBox[{"-", "0.010408712598449088`"}], "0.040628622992310764`", 
      RowBox[{"-", "0.05980486995604647`"}], 
      RowBox[{"-", "0.020049964663194128`"}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}], 
      RowBox[{"-", "0.010408712598449088`"}], "0.040628622992310764`", 
      RowBox[{"-", "0.05980486995604647`"}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0.05980486995604647`", "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}], 
      RowBox[{"-", "0.010408712598449088`"}], "0.040628622992310764`", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "0.04062862299231075`"}], "0.05980486995604647`", 
      "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}], 
      RowBox[{"-", "0.010408712598449088`"}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0.0104087125984492`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.05980486995604647`", 
      "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0.00334581200954714`", "0.0104087125984492`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.05980486995604647`", 
      "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "0.011624724071965924`"}], "0.00334581200954714`", 
      "0.0104087125984492`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.05980486995604647`", 
      "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0"},
     {"0.04130706006451381`", 
      RowBox[{"-", "0.011624724071965924`"}], "0.00334581200954714`", 
      "0.0104087125984492`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.05980486995604647`", 
      "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "0.12316898331781567`"}], "0.04130706006451381`", 
      RowBox[{"-", "0.011624724071965924`"}], "0.00334581200954714`", 
      "0.0104087125984492`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.05980486995604647`", 
      "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0",
       "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.781276667347165*^9, {3.7812772427280817`*^9, 3.7812772633477163`*^9}, 
   3.7812781206680813`*^9},
 CellLabel->
  "Out[131]//MatrixForm=",ExpressionUUID->"da025871-3b07-4470-b4a8-\
8d1585580587"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "0.999999999999998`"}], "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "0.999999999999998`"}], "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "0.9999999999999981`"}], "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "0.999999999999998`"}], "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "0.999999999999998`"}], "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "0.999999999999998`"}], "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.9999999999999979`"}], "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.9999999999999979`"}], "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.9999999999999979`"}], "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.9999999999999979`"}], "0", "0", "0", "0", "0", "0", "0",
       "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.999999999999998`"}], "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.999999999999998`"}], "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.999999999999998`"}], "0", "0", "0", "0", "0", "0", "0", 
      "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.999999999999998`"}], "0", "0", "0", "0", "0", "0", "0", 
      "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.9999999999999979`"}], "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", 
      RowBox[{"-", "0.9999999999999979`"}], "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", 
      RowBox[{"-", "0.999999999999998`"}], "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", 
      RowBox[{"-", "0.9999999999999979`"}], "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", 
      RowBox[{"-", "0.9999999999999979`"}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.9999999999999979`"}], "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.9999999999999979`"}], "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
      "0", "0", "0", "0", "0", "0", "0", 
      RowBox[{"-", "0.999999999999998`"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.781276667347165*^9, {3.7812772427280817`*^9, 3.7812772633477163`*^9}, 
   3.781278120752864*^9},
 CellLabel->
  "Out[132]//MatrixForm=",ExpressionUUID->"77205537-6c3b-44f7-a523-\
13c67f86d1ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tra", "=", 
   RowBox[{"GOqqppFROMaabb", "[", "1", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JJ", "=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{
        RowBox[{"uu", " ", 
         RowBox[{"Conjugate", "[", "uu", "]"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", 
           RowBox[{"(", 
            RowBox[{"j", "-", "l"}], ")"}]}]]}], "-", 
        RowBox[{"vv", " ", 
         RowBox[{"Conjugate", "[", "vv", "]"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", 
           RowBox[{"(", 
            RowBox[{"l", "-", "j"}], ")"}]}]]}]}], 
       RowBox[{
        RowBox[{"Conjugate", "[", "uu", "]"}], 
        RowBox[{"Conjugate", "[", " ", "vv", "]"}], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", 
            RowBox[{"(", 
             RowBox[{"l", "-", "j"}], ")"}], " "}]], "-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", 
            RowBox[{"(", 
             RowBox[{"j", "-", "l"}], ")"}], " "}]]}], ")"}]}]},
      {
       RowBox[{"uu", " ", "vv", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", 
            RowBox[{"(", 
             RowBox[{"l", "-", "j"}], ")"}], " "}]], "-", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "k", 
            RowBox[{"(", 
             RowBox[{"j", "-", "l"}], ")"}], " "}]]}], ")"}]}], 
       RowBox[{
        RowBox[{"vv", " ", 
         RowBox[{"Conjugate", "[", "vv", "]"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", 
           RowBox[{"(", 
            RowBox[{"j", "-", "l"}], ")"}]}]]}], "-", 
        RowBox[{"uu", " ", 
         RowBox[{"Conjugate", "[", "uu", "]"}], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"\[ImaginaryI]", " ", "k", 
           RowBox[{"(", 
            RowBox[{"l", "-", "j"}], ")"}]}]]}]}]}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Jtra", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"tra", ".", "JJ", ".", 
     RowBox[{"Transpose", "[", "tra", "]"}]}], "//", "FullSimplify"}], "//", 
   "MatrixForm"}]}]}], "Input",
 CellChangeTimes->{{3.7812763734595776`*^9, 3.7812765390778155`*^9}, {
  3.781276680786215*^9, 3.781276701586589*^9}, {3.7812768698185225`*^9, 
  3.7812768817685757`*^9}, {3.7812770182891006`*^9, 3.7812770512264986`*^9}, {
  3.7812774089217443`*^9, 3.781277446241787*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"34ab3c57-1cd6-416b-be74-1e35039ff9ba"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"(", 
        RowBox[{"vv", "-", 
         RowBox[{"Conjugate", "[", "uu", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"uu", "-", 
         RowBox[{"Conjugate", "[", "vv", "]"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"k", " ", 
         RowBox[{"(", 
          RowBox[{"j", "-", "l"}], ")"}]}], "]"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", "uu", "]"}], "2"], "-", 
          RowBox[{"vv", " ", 
           RowBox[{"Conjugate", "[", "vv", "]"}]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"j", "-", "l"}], ")"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "uu"}], " ", "vv"}], "+", 
          RowBox[{
           RowBox[{"Conjugate", "[", "uu", "]"}], " ", 
           RowBox[{"Conjugate", "[", "vv", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"j", "-", "l"}], ")"}]}], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", "uu", "]"}], "2"], "-", 
          RowBox[{"vv", " ", 
           RowBox[{"Conjugate", "[", "vv", "]"}]}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"j", "-", "l"}], ")"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"uu", " ", "vv"}], "-", 
          RowBox[{
           RowBox[{"Conjugate", "[", "uu", "]"}], " ", 
           RowBox[{"Conjugate", "[", "vv", "]"}]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"j", "-", "l"}], ")"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"(", 
        RowBox[{"vv", "+", 
         RowBox[{"Conjugate", "[", "uu", "]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"uu", "+", 
         RowBox[{"Conjugate", "[", "vv", "]"}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"k", " ", 
         RowBox[{"(", 
          RowBox[{"j", "-", "l"}], ")"}]}], "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7812774477856445`*^9},
 CellLabel->
  "Out[83]//MatrixForm=",ExpressionUUID->"2cbc63c9-57c9-4df0-93d7-\
5e63723d0972"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vec1", "=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "L"]}], 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"u", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], "]"}], 
            "]"}], "2"], "-", 
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{"v", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], "]"}], 
            "]"}], "2"]}], ")"}], 
        RowBox[{"Cos", "[", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], "x"}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "1", ",", "L"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7812773859631224`*^9, 3.7812774022734923`*^9}, {
  3.7812774532839108`*^9, 3.7812775203693557`*^9}, {3.7812776723885856`*^9, 
  3.7812776992813525`*^9}, {3.781277739020069*^9, 3.781277748424444*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"bb747954-d515-4c26-a248-333810b57b9b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5043004048659937`", ",", 
   RowBox[{"-", "0.18241957165909886`"}], ",", "0.01583734436758003`", ",", 
   "0.028229528973249637`", ",", 
   RowBox[{"-", "0.025518667795379934`"}], ",", "0.025518667795379934`", ",", 
   
   RowBox[{"-", "0.028229528973249637`"}], ",", 
   RowBox[{"-", "0.01583734436758003`"}], ",", "0.18241957165909886`", ",", 
   RowBox[{"-", "0.5043004048659937`"}], ",", 
   RowBox[{"-", "0.29761824824808664`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7812775228258305`*^9, 3.781277699654354*^9, {3.781277741982113*^9, 
   3.781277748748545*^9}},
 CellLabel->"Out[98]=",ExpressionUUID->"71df0c40-c270-4172-aa22-c16d68a1aaa5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cor", "=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", "\[Pi]", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "+", "1"}], ")"}], "/", "L"}]}]], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"part1", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           SqrtBox["L"]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               RowBox[{"v", "[", 
                FractionBox[
                 RowBox[{
                  RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], 
                "]"}], "]"}], "2"], "-", 
             SuperscriptBox[
              RowBox[{"Abs", "[", 
               RowBox[{"u", "[", 
                FractionBox[
                 RowBox[{
                  RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], 
                "]"}], "]"}], "2"]}], "//", "N"}], ")"}], 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"\[ImaginaryI]", " ", "2", "\[Pi]", " ", 
            RowBox[{"k", "/", "L"}]}]]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", 
           RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}], "//", "Fourier"}], 
      ")"}], "*", "cor"}], ")"}], "//", "Re"}]}]}], "Input",
 CellChangeTimes->{{3.781277573530068*^9, 3.7812775745553207`*^9}, {
  3.7812776381521435`*^9, 3.781277662597742*^9}, {3.7812776940127325`*^9, 
  3.7812776944306087`*^9}, {3.781277959603281*^9, 3.7812779606684346`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"4ef15e1c-e9a0-4916-9ffb-1b599c108ee2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5043004048659938`", ",", 
   RowBox[{"-", "0.18241957165909892`"}], ",", "0.015837344367580088`", ",", 
   "0.02822952897324967`", ",", 
   RowBox[{"-", "0.025518667795379923`"}], ",", "0.025518667795379917`", ",", 
   
   RowBox[{"-", "0.028229528973249613`"}], ",", 
   RowBox[{"-", "0.015837344367580115`"}], ",", "0.18241957165909894`", ",", 
   RowBox[{"-", "0.5043004048659937`"}], ",", 
   RowBox[{"-", "0.2976182482480866`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.781277575916647*^9, {3.7812776961809244`*^9, 3.7812777015732536`*^9}, 
   3.781277974398658*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"2d63d6f9-3042-495e-871e-3c1b1e134cf5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vec2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[ImaginaryI]", "L"]}], 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"u", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], "]"}], 
            
            RowBox[{"v", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], 
             "]"}]}], "-", 
           RowBox[{"Conjugate", "[", 
            RowBox[{
             RowBox[{"u", "[", 
              FractionBox[
               RowBox[{
                RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], "]"}], 
             RowBox[{"v", "[", 
              FractionBox[
               RowBox[{
                RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], 
              "]"}]}], "]"}]}], ")"}], 
         RowBox[{"Sin", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], "x"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "L"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", "L"}], "}"}]}], "]"}]}], "//", 
   "Chop"}]}], "\[IndentingNewLine]", 
 RowBox[{"part2", "=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            SqrtBox["L"]], "2", 
           RowBox[{"Im", "[", 
            RowBox[{
             RowBox[{"v", "[", 
              FractionBox[
               RowBox[{
                RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], "]"}], 
             RowBox[{"u", "[", 
              FractionBox[
               RowBox[{
                RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], 
              "]"}]}], "]"}], 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "2", "\[Pi]", " ", 
             RowBox[{"k", "/", "L"}]}]]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "0", ",", 
            RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}], "//", "Fourier"}], 
       ")"}], "*", "cor"}], ")"}], "//", "Im"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.781277815923863*^9, 3.781277816052519*^9}, {
  3.781277860303133*^9, 3.781277966034084*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"26aeed0d-cb87-4333-9b9d-baedfba75dc7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.381131421548178`", ",", 
   RowBox[{"-", "0.14111251159458507`"}], ",", "0.004212620295614142`", ",", 
   "0.031575340982796796`", ",", 
   RowBox[{"-", "0.015109955196930836`"}], ",", 
   RowBox[{"-", "0.015109955196930836`"}], ",", "0.031575340982796796`", ",", 
   "0.004212620295614142`", ",", 
   RowBox[{"-", "0.14111251159458507`"}], ",", "0.381131421548178`", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.7812779046716595`*^9, 3.781277937707821*^9}, 
   3.7812779756241446`*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"b61ff054-797a-4bc6-b249-680f0b232f5d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.381131421548178`", ",", 
   RowBox[{"-", "0.14111251159458502`"}], ",", "0.004212620295614164`", ",", 
   "0.031575340982796817`", ",", 
   RowBox[{"-", "0.015109955196930857`"}], ",", 
   RowBox[{"-", "0.01510995519693082`"}], ",", "0.03157534098279678`", ",", 
   "0.0042126202956141445`", ",", 
   RowBox[{"-", "0.14111251159458507`"}], ",", "0.381131421548178`", ",", 
   "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.7812779046716595`*^9, 3.781277937707821*^9}, 
   3.781277975636114*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"059e0e22-7863-48f5-bce4-6347e451335a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ft", "=", 
  RowBox[{"part1", "+", "part2"}]}], "\[IndentingNewLine]", 
 RowBox[{"-", 
  RowBox[{"Reverse", "[", "ft", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7812779687368383`*^9, 3.7812779716769857`*^9}, {
  3.781278015278098*^9, 3.781278015719907*^9}, {3.7812784578070354`*^9, 
  3.781278578209084*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"c86d06f2-cb62-4daa-b74d-b79cfff9d167"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8854318264141718`", ",", 
   RowBox[{"-", "0.32353208325368393`"}], ",", "0.020049964663194253`", ",", 
   "0.05980486995604649`", ",", 
   RowBox[{"-", "0.04062862299231078`"}], ",", "0.010408712598449096`", ",", 
   "0.0033458120095471687`", ",", 
   RowBox[{"-", "0.01162472407196597`"}], ",", "0.04130706006451387`", ",", 
   RowBox[{"-", "0.12316898331781573`"}], ",", 
   RowBox[{"-", "0.2976182482480866`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7812779723152647`*^9, 3.7812779777747593`*^9}, 
   3.7812780165646396`*^9, {3.781278469044194*^9, 3.781278579415592*^9}},
 CellLabel->
  "Out[187]=",ExpressionUUID->"8ae93b63-1b29-4ce6-b34a-daf61b695cc4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.2976182482480866`", ",", "0.12316898331781573`", ",", 
   RowBox[{"-", "0.04130706006451387`"}], ",", "0.01162472407196597`", ",", 
   RowBox[{"-", "0.0033458120095471687`"}], ",", 
   RowBox[{"-", "0.010408712598449096`"}], ",", "0.04062862299231078`", ",", 
   RowBox[{"-", "0.05980486995604649`"}], ",", 
   RowBox[{"-", "0.020049964663194253`"}], ",", "0.32353208325368393`", ",", 
   RowBox[{"-", "0.8854318264141718`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7812779723152647`*^9, 3.7812779777747593`*^9}, 
   3.7812780165646396`*^9, {3.781278469044194*^9, 3.7812785794235687`*^9}},
 CellLabel->
  "Out[188]=",ExpressionUUID->"42552ad8-9fc1-47f2-bc1e-5f578476a271"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToeplitzMatrix", "[", 
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{
      RowBox[{"RotateRight", "[", 
       RowBox[{"ft", ",", "1"}], "]"}], ",", 
      RowBox[{"1", "\[Rule]", 
       RowBox[{"-", 
        RowBox[{"Last", "[", "ft", "]"}]}]}]}], "]"}], ",", 
    RowBox[{"-", 
     RowBox[{"Reverse", "[", "ft", "]"}]}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JTRA", "\[LeftDoubleBracket]", 
   RowBox[{
    RowBox[{
     RowBox[{"L", "+", "1"}], ";;", 
     RowBox[{"2", "L"}]}], ",", 
    RowBox[{"1", ";;", "L"}]}], "\[RightDoubleBracket]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.781278021031829*^9, 3.7812780220536013`*^9}, {
   3.781278053079241*^9, 3.781278054553297*^9}, 3.7812780890759487`*^9, {
   3.781278128629384*^9, 3.7812782654429045`*^9}, {3.7812785944489594`*^9, 
   3.7812787438983126`*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"1e4537ad-22bb-4e46-8995-11ad0d5ec647"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.2976182482480866`", "0.12316898331781573`", 
      RowBox[{"-", "0.04130706006451387`"}], "0.01162472407196597`", 
      RowBox[{"-", "0.0033458120095471687`"}], 
      RowBox[{"-", "0.010408712598449096`"}], "0.04062862299231078`", 
      RowBox[{"-", "0.05980486995604649`"}], 
      RowBox[{"-", "0.020049964663194253`"}], "0.32353208325368393`", 
      RowBox[{"-", "0.8854318264141718`"}]},
     {"0.8854318264141718`", "0.2976182482480866`", "0.12316898331781573`", 
      RowBox[{"-", "0.04130706006451387`"}], "0.01162472407196597`", 
      RowBox[{"-", "0.0033458120095471687`"}], 
      RowBox[{"-", "0.010408712598449096`"}], "0.04062862299231078`", 
      RowBox[{"-", "0.05980486995604649`"}], 
      RowBox[{"-", "0.020049964663194253`"}], "0.32353208325368393`"},
     {
      RowBox[{"-", "0.32353208325368393`"}], "0.8854318264141718`", 
      "0.2976182482480866`", "0.12316898331781573`", 
      RowBox[{"-", "0.04130706006451387`"}], "0.01162472407196597`", 
      RowBox[{"-", "0.0033458120095471687`"}], 
      RowBox[{"-", "0.010408712598449096`"}], "0.04062862299231078`", 
      RowBox[{"-", "0.05980486995604649`"}], 
      RowBox[{"-", "0.020049964663194253`"}]},
     {"0.020049964663194253`", 
      RowBox[{"-", "0.32353208325368393`"}], "0.8854318264141718`", 
      "0.2976182482480866`", "0.12316898331781573`", 
      RowBox[{"-", "0.04130706006451387`"}], "0.01162472407196597`", 
      RowBox[{"-", "0.0033458120095471687`"}], 
      RowBox[{"-", "0.010408712598449096`"}], "0.04062862299231078`", 
      RowBox[{"-", "0.05980486995604649`"}]},
     {"0.05980486995604649`", "0.020049964663194253`", 
      RowBox[{"-", "0.32353208325368393`"}], "0.8854318264141718`", 
      "0.2976182482480866`", "0.12316898331781573`", 
      RowBox[{"-", "0.04130706006451387`"}], "0.01162472407196597`", 
      RowBox[{"-", "0.0033458120095471687`"}], 
      RowBox[{"-", "0.010408712598449096`"}], "0.04062862299231078`"},
     {
      RowBox[{"-", "0.04062862299231078`"}], "0.05980486995604649`", 
      "0.020049964663194253`", 
      RowBox[{"-", "0.32353208325368393`"}], "0.8854318264141718`", 
      "0.2976182482480866`", "0.12316898331781573`", 
      RowBox[{"-", "0.04130706006451387`"}], "0.01162472407196597`", 
      RowBox[{"-", "0.0033458120095471687`"}], 
      RowBox[{"-", "0.010408712598449096`"}]},
     {"0.010408712598449096`", 
      RowBox[{"-", "0.04062862299231078`"}], "0.05980486995604649`", 
      "0.020049964663194253`", 
      RowBox[{"-", "0.32353208325368393`"}], "0.8854318264141718`", 
      "0.2976182482480866`", "0.12316898331781573`", 
      RowBox[{"-", "0.04130706006451387`"}], "0.01162472407196597`", 
      RowBox[{"-", "0.0033458120095471687`"}]},
     {"0.0033458120095471687`", "0.010408712598449096`", 
      RowBox[{"-", "0.04062862299231078`"}], "0.05980486995604649`", 
      "0.020049964663194253`", 
      RowBox[{"-", "0.32353208325368393`"}], "0.8854318264141718`", 
      "0.2976182482480866`", "0.12316898331781573`", 
      RowBox[{"-", "0.04130706006451387`"}], "0.01162472407196597`"},
     {
      RowBox[{"-", "0.01162472407196597`"}], "0.0033458120095471687`", 
      "0.010408712598449096`", 
      RowBox[{"-", "0.04062862299231078`"}], "0.05980486995604649`", 
      "0.020049964663194253`", 
      RowBox[{"-", "0.32353208325368393`"}], "0.8854318264141718`", 
      "0.2976182482480866`", "0.12316898331781573`", 
      RowBox[{"-", "0.04130706006451387`"}]},
     {"0.04130706006451387`", 
      RowBox[{"-", "0.01162472407196597`"}], "0.0033458120095471687`", 
      "0.010408712598449096`", 
      RowBox[{"-", "0.04062862299231078`"}], "0.05980486995604649`", 
      "0.020049964663194253`", 
      RowBox[{"-", "0.32353208325368393`"}], "0.8854318264141718`", 
      "0.2976182482480866`", "0.12316898331781573`"},
     {
      RowBox[{"-", "0.12316898331781573`"}], "0.04130706006451387`", 
      RowBox[{"-", "0.01162472407196597`"}], "0.0033458120095471687`", 
      "0.010408712598449096`", 
      RowBox[{"-", "0.04062862299231078`"}], "0.05980486995604649`", 
      "0.020049964663194253`", 
      RowBox[{"-", "0.32353208325368393`"}], "0.8854318264141718`", 
      "0.2976182482480866`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.781278019280348*^9, 3.781278022380723*^9}, 
   3.781278054871456*^9, 3.7812780894788275`*^9, {3.7812781453287115`*^9, 
   3.781278160728467*^9}, {3.781278198064637*^9, 3.781278265966466*^9}, 
   3.781278598663915*^9, {3.781278641020084*^9, 3.781278748892792*^9}},
 CellLabel->
  "Out[212]//MatrixForm=",ExpressionUUID->"8da64e7b-1f5e-425e-998e-\
651fe0e7d08a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}], 
      RowBox[{"-", "0.010408712598449088`"}], "0.040628622992310764`", 
      RowBox[{"-", "0.05980486995604647`"}], 
      RowBox[{"-", "0.020049964663194128`"}], "0.32353208325368393`", 
      RowBox[{"-", "0.8854318264141715`"}]},
     {"0.8854318264141715`", "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}], 
      RowBox[{"-", "0.010408712598449088`"}], "0.040628622992310764`", 
      RowBox[{"-", "0.05980486995604647`"}], 
      RowBox[{"-", "0.020049964663194128`"}], "0.32353208325368393`"},
     {
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}], 
      RowBox[{"-", "0.010408712598449088`"}], "0.040628622992310764`", 
      RowBox[{"-", "0.05980486995604647`"}], 
      RowBox[{"-", "0.020049964663194128`"}]},
     {"0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}], 
      RowBox[{"-", "0.010408712598449088`"}], "0.040628622992310764`", 
      RowBox[{"-", "0.05980486995604647`"}]},
     {"0.05980486995604647`", "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}], 
      RowBox[{"-", "0.010408712598449088`"}], "0.040628622992310764`"},
     {
      RowBox[{"-", "0.04062862299231075`"}], "0.05980486995604647`", 
      "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}], 
      RowBox[{"-", "0.010408712598449088`"}]},
     {"0.0104087125984492`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.05980486995604647`", 
      "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`", 
      RowBox[{"-", "0.0033458120095471106`"}]},
     {"0.00334581200954714`", "0.0104087125984492`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.05980486995604647`", 
      "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}], "0.011624724071965877`"},
     {
      RowBox[{"-", "0.011624724071965924`"}], "0.00334581200954714`", 
      "0.0104087125984492`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.05980486995604647`", 
      "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`", 
      RowBox[{"-", "0.04130706006451379`"}]},
     {"0.04130706006451381`", 
      RowBox[{"-", "0.011624724071965924`"}], "0.00334581200954714`", 
      "0.0104087125984492`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.05980486995604647`", 
      "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`", "0.12316898331781567`"},
     {
      RowBox[{"-", "0.12316898331781567`"}], "0.04130706006451381`", 
      RowBox[{"-", "0.011624724071965924`"}], "0.00334581200954714`", 
      "0.0104087125984492`", 
      RowBox[{"-", "0.04062862299231075`"}], "0.05980486995604647`", 
      "0.02004996466319413`", 
      RowBox[{"-", "0.3235320832536838`"}], "0.8854318264141715`", 
      "0.2976182482480866`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.781278019280348*^9, 3.781278022380723*^9}, 
   3.781278054871456*^9, 3.7812780894788275`*^9, {3.7812781453287115`*^9, 
   3.781278160728467*^9}, {3.781278198064637*^9, 3.781278265966466*^9}, 
   3.781278598663915*^9, {3.781278641020084*^9, 3.7812787489067554`*^9}},
 CellLabel->
  "Out[213]//MatrixForm=",ExpressionUUID->"4fc9c5bc-4429-434b-be8e-\
c7ccd9f601de"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "RotateLeft"}]], "Input",
 CellChangeTimes->{{3.7812781728443284`*^9, 3.781278179519021*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"1b9d7152-3a03-46bb-b82f-3cf40f140e92"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"]], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"]]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/RotateLeft",
              ButtonNote->"paclet:ref/RotateLeft"],
             "\"paclet:ref/RotateLeft\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"RotateLeft\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\
\"TI\\\"]}], \\\"]\\\"}]\\) cycles the elements in \\!\\(\\*StyleBox[\\\"expr\
\\\", \\\"TI\\\"]\\) \\!\\(\\*StyleBox[\\\"n\\\", \\\"TI\\\"]\\) positions to \
the left. \\n\\!\\(\\*RowBox[{\\\"RotateLeft\\\", \\\"[\\\", \
StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\"]\\\"}]\\) cycles one position to the \
left. \\n\\!\\(\\*RowBox[{\\\"RotateLeft\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\
\"TR\\\"]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) cycles elements at successive \
levels \\!\\(\\*SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], \
StyleBox[\\\"i\\\", \\\"TI\\\"]]\\) positions to the left. \"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False, False, False, False, 
                False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Documentation\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Documentation\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Documentation", "Tooltip"]& ], 
                   
                   TemplateBox[{
                    TemplateBox[{
                    "\"Local \[RightGuillemet]\"", "paclet:ref/RotateLeft", 
                    "paclet:ref/RotateLeft", "Link", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"],"\"  \"",StyleBox[
                    "\"|\"", "InformationRowLabel", StripOnInput -> False],
                    "\"  \"",TemplateBox[{"\"Web \[RightGuillemet]\"", {
                    URL[
                    "http://reference.wolfram.com/language/ref/RotateLeft.\
html"], None}, "http://reference.wolfram.com/language/ref/RotateLeft.html", 
                    "Hyperlink", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"]},
                    "RowDefault"]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Attributes\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Attributes\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Attributes", "Tooltip"]& ], 
                   RowBox[{"{", "Protected", "}"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"System`RotateLeft\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->6], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{13., {4., 9.}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{13., {4., 9.}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/RotateLeft",
              ButtonNote->"paclet:ref/RotateLeft"],
             "\"paclet:ref/RotateLeft\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"RotateLeft\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"n\\\", \\\
\"TI\\\"]}], \\\"]\\\"}]\\) cycles the elements in \\!\\(\\*StyleBox[\\\"expr\
\\\", \\\"TI\\\"]\\) \\!\\(\\*StyleBox[\\\"n\\\", \\\"TI\\\"]\\) positions to \
the left. \\n\\!\\(\\*RowBox[{\\\"RotateLeft\\\", \\\"[\\\", \
StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\"]\\\"}]\\) cycles one position to the \
left. \\n\\!\\(\\*RowBox[{\\\"RotateLeft\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"expr\\\", \\\"TI\\\"], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], StyleBox[\\\"1\\\", \
\\\"TR\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], \
StyleBox[\\\"2\\\", \\\"TR\\\"]], \\\",\\\", StyleBox[\\\"\[Ellipsis]\\\", \\\
\"TR\\\"]}], \\\"}\\\"}]}], \\\"]\\\"}]\\) cycles elements at successive \
levels \\!\\(\\*SubscriptBox[StyleBox[\\\"n\\\", \\\"TI\\\"], \
StyleBox[\\\"i\\\", \\\"TI\\\"]]\\) positions to the left. \"\>", 
             "InformationUsageText",
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{10., {2., 8.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{10., {2., 8.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[
   Association[
   "ObjectType" -> "Symbol", "Usage" -> 
    "\!\(\*RowBox[{\"RotateLeft\", \"[\", RowBox[{StyleBox[\"expr\", \"TI\"], \
\",\", StyleBox[\"n\", \"TI\"]}], \"]\"}]\) cycles the elements in \
\!\(\*StyleBox[\"expr\", \"TI\"]\) \!\(\*StyleBox[\"n\", \"TI\"]\) positions \
to the left. \n\!\(\*RowBox[{\"RotateLeft\", \"[\", StyleBox[\"expr\", \
\"TI\"], \"]\"}]\) cycles one position to the left. \n\
\!\(\*RowBox[{\"RotateLeft\", \"[\", RowBox[{StyleBox[\"expr\", \"TI\"], \
\",\", RowBox[{\"{\", RowBox[{SubscriptBox[StyleBox[\"n\", \"TI\"], StyleBox[\
\"1\", \"TR\"]], \",\", SubscriptBox[StyleBox[\"n\", \"TI\"], StyleBox[\"2\", \
\"TR\"]], \",\", StyleBox[\"\[Ellipsis]\", \"TR\"]}], \"}\"}]}], \"]\"}]\) \
cycles elements at successive levels \!\(\*SubscriptBox[StyleBox[\"n\", \
\"TI\"], StyleBox[\"i\", \"TI\"]]\) positions to the left. ", "Documentation" -> 
    Association[
     "Local" -> "paclet:ref/RotateLeft", "Web" -> 
      "http://reference.wolfram.com/language/ref/RotateLeft.html"], 
    "OwnValues" -> None, "UpValues" -> None, "DownValues" -> None, 
    "SubValues" -> None, "DefaultValues" -> None, "NValues" -> None, 
    "FormatValues" -> None, "Options" -> None, "Attributes" -> {Protected}, 
    "FullName" -> "System`RotateLeft"], False]]], "Output",
 CellChangeTimes->{{3.7812781775742044`*^9, 3.781278179944869*^9}},
 CellLabel->
  "Out[140]=",ExpressionUUID->"a0c0c645-ee8e-4fc9-9f51-c4854b3fb6cb"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.7812779078711395`*^9},ExpressionUUID->"fc495ec6-ea20-4c1e-bb46-\
98e49b83b462"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Covariance matrix of ground state of the XY model",
 FontWeight->"Bold",
 FontSlant->"Italic"]], "Subsubsection",
 CellChangeTimes->{{3.775541412824267*^9, 3.7755416727390947`*^9}, {
  3.7755421075764008`*^9, 3.775542108507226*^9}, {3.77572309702594*^9, 
  3.775723107081567*^9}, {3.7760828975986233`*^9, 3.7760829005628567`*^9}, {
  3.777889311762621*^9, 3.7778893565160174`*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"dcef1e44-2bc6-4555-9e45-cac65424abe2"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"XYft", ",", "XYcm", ",", "XYcmRes"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XYft", "[", 
    RowBox[{"{", 
     RowBox[{"L_", ",", "J_", ",", "h_", ",", "\[Gamma]_"}], "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"XYft", "[", 
     RowBox[{"{", 
      RowBox[{"L", ",", "J", ",", "h", ",", "\[Gamma]"}], "}"}], "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Epsilon]", ",", "a", ",", "b", ",", "u", ",", "v", ",", "cor", ",", 
        "part1", ",", "part2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"u", "[", "0", "]"}], "=", "0"}], ";", 
       RowBox[{
        RowBox[{"v", "[", "0", "]"}], "=", "\[ImaginaryI]"}], ";", 
       RowBox[{
        RowBox[{"u", "[", "\[Pi]", "]"}], "=", "1"}], ";", 
       RowBox[{
        RowBox[{"v", "[", "\[Pi]", "]"}], "=", "0"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "This", " ", "is", " ", "no", " ", "really", " ", "needed", " ", 
          "for", " ", "even", " ", "number", " ", "of", " ", "excitations"}], 
         ",", " ", 
         RowBox[{"but", " ", "would", " ", "be", " ", "relevant"}], ",", " ", 
         
         RowBox[{
         "if", " ", "we", " ", "were", " ", "to", " ", "construct", " ", 
          "eigenstates", " ", "with", " ", "odd", " ", "number", " ", "of", 
          " ", 
          RowBox[{"excitations", "!"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "k_", "]"}], ":=", 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "k", "]"}], "=", 
         SqrtBox[
          RowBox[{
           SuperscriptBox["h", "2"], "+", 
           RowBox[{"2", "h", " ", "J", " ", 
            RowBox[{"Cos", "[", "k", "]"}]}], "+", 
           SuperscriptBox["J", "2"], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Gamma]", "2"], "-", "1"}], ")"}], 
            SuperscriptBox["J", "2"], 
            SuperscriptBox[
             RowBox[{"Sin", "[", "k", "]"}], "2"]}]}]]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "[", "k_", "]"}], ":=", 
        RowBox[{
         RowBox[{"a", "[", "k", "]"}], "=", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "J"}], " ", 
           RowBox[{"Cos", "[", "k", "]"}]}], "-", "h"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"b", "[", "k_", "]"}], ":=", 
        RowBox[{
         RowBox[{"b", "[", "k", "]"}], "=", 
         RowBox[{"\[Gamma]", " ", "J", " ", 
          RowBox[{"Sin", "[", "k", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"u", "[", "k_", "]"}], ":=", 
        RowBox[{
         RowBox[{"u", "[", "k", "]"}], "=", 
         FractionBox[
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "k", "]"}], "+", 
           RowBox[{"a", "[", "k", "]"}]}], 
          SqrtBox[
           RowBox[{"2", 
            RowBox[{"\[Epsilon]", "[", "k", "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "k", "]"}], "+", 
              RowBox[{"a", "[", "k", "]"}]}], ")"}]}]]]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"v", "[", "k_", "]"}], ":=", 
        RowBox[{
         RowBox[{"v", "[", "k", "]"}], "=", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           RowBox[{"b", "[", "k", "]"}]}], 
          SqrtBox[
           RowBox[{"2", 
            RowBox[{"\[Epsilon]", "[", "k", "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "k", "]"}], "+", 
              RowBox[{"a", "[", "k", "]"}]}], ")"}]}]]]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cor", "=", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"\[ImaginaryI]", " ", "\[Pi]", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "+", "1"}], ")"}], "/", "L"}]}]], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", 
             RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"part1", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                FractionBox["1", 
                 SqrtBox["L"]], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"Abs", "[", 
                    RowBox[{"v", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], 
                    "]"}], "]"}], "2"], "-", 
                   SuperscriptBox[
                    RowBox[{"Abs", "[", 
                    RowBox[{"u", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], 
                    "]"}], "]"}], "2"]}], "//", "N"}], ")"}], 
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"\[ImaginaryI]", " ", "2", "\[Pi]", " ", 
                  RowBox[{"k", "/", "L"}]}]]}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "0", ",", 
                 RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}], "//", "Fourier"}],
             ")"}], "*", "cor"}], ")"}], "//", "Re"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"part2", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 FractionBox["1", 
                  SqrtBox["L"]], "2", 
                 RowBox[{"Im", "[", 
                  RowBox[{
                   RowBox[{"v", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], 
                    "]"}], 
                   RowBox[{"u", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"2", "\[Pi]", " ", "k"}], "+", "\[Pi]"}], "L"], 
                    "]"}]}], "]"}], 
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"\[ImaginaryI]", " ", "2", "\[Pi]", " ", 
                   RowBox[{"k", "/", "L"}]}]]}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "0", ",", 
                  RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}], "//", 
              "Fourier"}], ")"}], "*", "cor"}], ")"}], "//", "Im"}], ")"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"part1", "+", "part2"}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XYcm", "[", "var_", "]"}], ":=", 
   RowBox[{
    RowBox[{"XYcm", "[", "var", "]"}], "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"L", ",", "ft", ",", "\[CapitalOmega]Block"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"L", "=", 
        RowBox[{
        "var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ft", "=", 
        RowBox[{"XYft", "[", "var", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[CapitalOmega]Block", "=", 
        RowBox[{"ToeplitzMatrix", "[", 
         RowBox[{
          RowBox[{"ReplacePart", "[", 
           RowBox[{
            RowBox[{"RotateRight", "[", 
             RowBox[{"ft", ",", "1"}], "]"}], ",", 
            RowBox[{"1", "\[Rule]", 
             RowBox[{"-", 
              RowBox[{"Last", "[", "ft", "]"}]}]}]}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Reverse", "[", "ft", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.", ",", "\[CapitalOmega]Block"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Transpose", "[", "\[CapitalOmega]Block", "]"}]}], ",", 
            "0."}], "}"}]}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}], 
  RowBox[{"(*", " ", 
   RowBox[{"in", " ", "qqpp", " ", "basis"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XYcmRes", "[", 
   RowBox[{"var_", ",", 
    RowBox[{"{", 
     RowBox[{"dimA_", ",", "dimB_", ",", "d_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"L", ",", "ind", ",", "\[CapitalOmega]Res"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"L", "=", 
      RowBox[{"var", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"ind", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "dimA"}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "+", "dimA", "+", "d"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "dimB"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalOmega]Res", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"j", "\[Equal]", "l"}], ",", 
          RowBox[{
           RowBox[{"XYft", "[", "var", "]"}], "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], ",", 
          RowBox[{
           RowBox[{"Sign", "[", 
            RowBox[{"j", "-", "l"}], "]"}], 
           RowBox[{
            RowBox[{"XYft", "[", "var", "]"}], "\[LeftDoubleBracket]", 
            RowBox[{"Mod", "[", 
             RowBox[{
              RowBox[{"j", "-", "l"}], ",", "L"}], "]"}], 
            "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "ind"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"l", ",", "ind"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"GOqpqpFROMqqpp", "[", 
       RowBox[{"dimA", "+", "dimB"}], "]"}], ".", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.", ",", "\[CapitalOmega]Res"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Transpose", "[", "\[CapitalOmega]Res", "]"}]}], ",", 
           "0."}], "}"}]}], "}"}], "]"}], ".", 
      RowBox[{"Transpose", "[", 
       RowBox[{"GOqpqpFROMqqpp", "[", 
        RowBox[{"dimA", "+", "dimB"}], "]"}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"in", " ", "qpqp", " ", "basis"}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7778306242748194`*^9, 3.777830671242294*^9}, {
   3.7778844773798685`*^9, 3.7778845185647964`*^9}, {3.777884581277189*^9, 
   3.777884733590116*^9}, {3.777884817125902*^9, 3.7778848230959053`*^9}, {
   3.7778871785506716`*^9, 3.7778873413057456`*^9}, {3.777887398262534*^9, 
   3.7778874305562153`*^9}, {3.777887497773574*^9, 3.7778875196899557`*^9}, {
   3.7778886702906265`*^9, 3.777888787640993*^9}, {3.7778888563423448`*^9, 
   3.7778888572639155`*^9}, {3.7778891431915445`*^9, 3.777889147931881*^9}, {
   3.777889179943227*^9, 3.7778891802334566`*^9}, {3.777889559336913*^9, 
   3.777889594827106*^9}, {3.7778903972416945`*^9, 3.777890400908961*^9}, {
   3.7778935874926777`*^9, 3.777893587860578*^9}, {3.77789397909623*^9, 
   3.7778941410689845`*^9}, {3.7778949810140963`*^9, 3.777894997583102*^9}, {
   3.777895044973511*^9, 3.7778950502038717`*^9}, {3.7778957457413287`*^9, 
   3.7778957473026175`*^9}, {3.777895784341517*^9, 3.777895817876625*^9}, {
   3.7778958561896152`*^9, 3.7778958568814325`*^9}, {3.7778959007571826`*^9, 
   3.7778959011058364`*^9}, {3.777896056334016*^9, 3.777896081908968*^9}, {
   3.7778961142733784`*^9, 3.7778961448188753`*^9}, {3.7778964307928123`*^9, 
   3.7778964617777405`*^9}, {3.777896512484344*^9, 3.777896548110276*^9}, {
   3.777896616818779*^9, 3.7778966201634607`*^9}, {3.777896664018718*^9, 
   3.7778966760630817`*^9}, {3.7778967825309186`*^9, 3.777896786448661*^9}, {
   3.777897007302984*^9, 3.777897013272197*^9}, {3.7778972502248464`*^9, 
   3.7778972823892097`*^9}, 3.7778974395414486`*^9, {3.7778975166273108`*^9, 
   3.7778975215753436`*^9}, {3.7778975958580647`*^9, 
   3.7778976021861415`*^9}, {3.7778977614194927`*^9, 
   3.7778977881682987`*^9}, {3.7778979453635373`*^9, 
   3.7778979631471605`*^9}, {3.777898056761818*^9, 3.777898072045698*^9}, {
   3.7778981136805787`*^9, 3.777898117046556*^9}, 
   3.781278769749672*^9},ExpressionUUID->"aa687e88-6a99-467d-82b2-\
437d739481f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"L", "=", "12"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Total", " ", "number", " ", "lattice", " ", "sites"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"J", "=", "1"}], ";", 
   RowBox[{"h", "=", "1"}], ";", 
   RowBox[{"\[Gamma]", "=", "1"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"XY", " ", "model", " ", "parameter"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"dimA1", "=", "1"}], ";", " ", 
   RowBox[{"dimB1", "=", "3"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"dofs", " ", "of", " ", "chosen", " ", "subystems"}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{"d", "=", "5"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"distance", " ", "subsystems"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"dimPur", "=", 
    RowBox[{"dimA1", "+", "dimB1"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "dimensions", " ", "of", " ", "the", " ", "purifying", " ", "system"}], 
   "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"JJ", "=", 
    RowBox[{"XYcm", "[", 
     RowBox[{"{", 
      RowBox[{"L", ",", "J", ",", "h", ",", "\[Gamma]"}], "}"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JJ", ".", "JJ"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7766752493384905`*^9, 3.776675304991503*^9}, {
   3.776675340236038*^9, 3.776675359125998*^9}, {3.776675400716584*^9, 
   3.77667540739126*^9}, {3.7766782918910627`*^9, 3.7766782981508265`*^9}, {
   3.776681109400042*^9, 3.7766811132731833`*^9}, {3.776767627232751*^9, 
   3.776767645137799*^9}, {3.7770247958176646`*^9, 3.7770247969831934`*^9}, {
   3.777204705416757*^9, 3.777204713102418*^9}, {3.7772048050920696`*^9, 
   3.7772048065142727`*^9}, {3.777204853317474*^9, 3.777204855609499*^9}, {
   3.777613394619652*^9, 3.7776134266920223`*^9}, {3.777614044319818*^9, 
   3.777614045223138*^9}, {3.777614489100884*^9, 3.7776145171550384`*^9}, {
   3.7776147024842234`*^9, 3.7776147033255644`*^9}, {3.7778820901669655`*^9, 
   3.7778821087862034`*^9}, {3.7778829602890897`*^9, 
   3.7778829613203354`*^9}, {3.7778830860254345`*^9, 
   3.7778830869010935`*^9}, {3.7778831819291215`*^9, 
   3.7778831828636255`*^9}, {3.7778832155552034`*^9, 
   3.7778832165036693`*^9}, {3.777883283310329*^9, 3.7778832842557755`*^9}, {
   3.777883359369193*^9, 3.777883360795429*^9}, {3.777883431354806*^9, 
   3.7778834322125144`*^9}, {3.777883668483843*^9, 3.7778836694183826`*^9}, 
   3.777889431516571*^9, 3.7778983513948708`*^9, {3.777898724552718*^9, 
   3.777898726900447*^9}, {3.7778987850218287`*^9, 3.777898804942713*^9}, {
   3.777915376505526*^9, 3.77791537991446*^9}, {3.7811952980541534`*^9, 
   3.78119529879819*^9}, 3.781195334029765*^9, {3.7811953791561003`*^9, 
   3.7811953999996185`*^9}, {3.781196237572423*^9, 3.7811962389871798`*^9}, 
   3.7811964009889507`*^9, {3.781196619981266*^9, 3.781196630090865*^9}, {
   3.781199684549037*^9, 3.7811997262646933`*^9}, {3.7812671899650764`*^9, 
   3.7812671957403183`*^9}},ExpressionUUID->"ef7a3c23-377e-487d-a70e-\
4a732d8b3637"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
SpellingDictionaries->{"CorrectWords"->{
 "Purifications", "\[Phi]\[Phi]\[Pi]\[Pi]"}},
Magnification:>0.5 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]]}, Visible -> False, 
  FrontEndVersion -> "12.0 for Microsoft Windows (64-bit) (April 8, 2019)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 227, 4, 96, "Title",ExpressionUUID->"f8b9e2fb-b1a1-4ed6-8c9b-37b0f3f20bec"],
Cell[810, 28, 415, 8, 34, "Text",ExpressionUUID->"151f29c7-c001-4f64-9fc6-433ea64370e2"],
Cell[1228, 38, 323, 7, 28, "Input",ExpressionUUID->"0b68122c-602a-4ffb-bddb-831b264acb38"],
Cell[1554, 47, 490, 9, 48, "Input",ExpressionUUID->"503c86a9-502e-4932-a8c7-48511032d24a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2081, 61, 222, 4, 96, "Title",ExpressionUUID->"2476762e-e7ac-4684-8f66-93120ddc5dcc"],
Cell[CellGroupData[{
Cell[2328, 69, 519, 9, 60, "Subsubsection",ExpressionUUID->"ca48de36-2306-46c3-9328-65aaa5ee769d"],
Cell[CellGroupData[{
Cell[2872, 82, 6688, 201, 444, "Input",ExpressionUUID->"eb1a0cfb-3065-47a2-8a93-7dcf054e6d2b"],
Cell[9563, 285, 10380, 193, 402, "Output",ExpressionUUID->"da025871-3b07-4470-b4a8-8d1585580587"],
Cell[19946, 480, 4256, 84, 402, "Output",ExpressionUUID->"77205537-6c3b-44f7-a523-13c67f86d1ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24239, 569, 2792, 71, 100, "Input",ExpressionUUID->"34ab3c57-1cd6-416b-be74-1e35039ff9ba"],
Cell[27034, 642, 3093, 92, 66, "Output",ExpressionUUID->"2cbc63c9-57c9-4df0-93d7-5e63723d0972"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30164, 739, 1397, 39, 46, "Input",ExpressionUUID->"bb747954-d515-4c26-a248-333810b57b9b"],
Cell[31564, 780, 694, 14, 32, "Output",ExpressionUUID->"71df0c40-c270-4172-aa22-c16d68a1aaa5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32295, 799, 1947, 54, 80, "Input",ExpressionUUID->"4ef15e1c-e9a0-4916-9ffb-1b599c108ee2"],
Cell[34245, 855, 700, 15, 32, "Output",ExpressionUUID->"2d63d6f9-3042-495e-871e-3c1b1e134cf5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34982, 875, 2679, 79, 95, "Input",ExpressionUUID->"26aeed0d-cb87-4333-9b9d-baedfba75dc7"],
Cell[37664, 956, 622, 13, 32, "Output",ExpressionUUID->"b61ff054-797a-4bc6-b249-680f0b232f5d"],
Cell[38289, 971, 621, 13, 32, "Output",ExpressionUUID->"059e0e22-7863-48f5-bce4-6347e451335a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38947, 989, 416, 9, 48, "Input",ExpressionUUID->"c86d06f2-cb62-4daa-b74d-b79cfff9d167"],
Cell[39366, 1000, 704, 13, 32, "Output",ExpressionUUID->"8ae93b63-1b29-4ce6-b34a-daf61b695cc4"],
Cell[40073, 1015, 717, 12, 32, "Output",ExpressionUUID->"42552ad8-9fc1-47f2-bc1e-5f578476a271"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40827, 1032, 1005, 27, 48, "Input",ExpressionUUID->"1e4537ad-22bb-4e46-8995-11ad0d5ec647"],
Cell[41835, 1061, 5038, 98, 215, "Output",ExpressionUUID->"8da64e7b-1f5e-425e-998e-651fe0e7d08a"],
Cell[46876, 1161, 5021, 98, 215, "Output",ExpressionUUID->"4fc9c5bc-4429-434b-be8e-c7ccd9f601de"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51934, 1264, 204, 4, 28, "Input",ExpressionUUID->"1b9d7152-3a03-46bb-b82f-3cf40f140e92"],
Cell[52141, 1270, 14388, 323, 141, "Output",ExpressionUUID->"a0c0c645-ee8e-4fc9-9f51-c4854b3fb6cb"]
}, Open  ]],
Cell[66544, 1596, 130, 3, 28, "Input",ExpressionUUID->"fc495ec6-ea20-4c1e-bb46-98e49b83b462"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66711, 1604, 493, 8, 60, "Subsubsection",ExpressionUUID->"dcef1e44-2bc6-4555-9e45-cac65424abe2"],
Cell[67207, 1614, 13127, 328, 698, "Input",ExpressionUUID->"aa687e88-6a99-467d-82b2-437d739481f3"],
Cell[80337, 1944, 3141, 62, 181, "Input",ExpressionUUID->"ef7a3c23-377e-487d-a70e-4a732d8b3637"]
}, Open  ]]
}, Open  ]]
}
]
*)

